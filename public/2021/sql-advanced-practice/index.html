<!DOCTYPE html>
<html lang="zh-cn">
    <head>
    <meta http-equiv="content-type" content="text/html;charset=utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noodp"/>
    <meta name="author" content="Yiming">
    <meta name="description" content="Yiming`s Blog">
    
    
    <link rel="prev" href="https://ymingliu.github.io/2021/sql-advanced/" />
    <link rel="next" href="https://ymingliu.github.io/2021/sql-advanced-application/" />
    <link rel="canonical" href="https://ymingliu.github.io/2021/sql-advanced-practice/" />
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="theme-color" content="#ffffff">
    <title>
        
        
            Advanced MySQL For Practice | Yiming`s Blog
        
    </title>
    <meta name="title" content="Advanced MySQL For Practice | Yiming`s Blog">
    
<link rel="stylesheet" href="/css/main.min.css">


    
    
 

<script type="application/ld+json">
{
    "@context" : "http://schema.org",
    "@type" : "BlogPosting",
    "mainEntityOfPage": {
         "@type": "WebPage",
         "@id": "https:\/\/ymingliu.github.io"
    },
    "articleSection" : "posts",
    "name" : "Advanced MySQL For Practice",
    "headline" : "Advanced MySQL For Practice",
    "description" : "课程参考 阿里云开发者社区——数据库学习路线 数据库及SQL\/MySQL进阶练习题 1、查出至少有一个员工的部门，显示部门编号、部门名称、部门位置",
    "inLanguage" : "zh-cn",
    "author" : "Yiming",
    "creator" : "Yiming",
    "publisher": "Yiming",
    "accountablePerson" : "Yiming",
    "copyrightHolder" : "Yiming",
    "copyrightYear" : "2021",
    "datePublished": "2021-03-10 09:48:59 \x2b0800 CST",
    "dateModified" : "2021-03-10 09:48:59 \x2b0800 CST",
    "url" : "https:\/\/ymingliu.github.io\/2021\/sql-advanced-practice\/",
    "wordCount" : "2410",
    "keywords" : [ "MySQL", "Yiming`s Blog"]
}
</script>

  </head>
    <body class="">
        <div class="wrapper">
            <nav class="navbar">
    
        <progress class="content_progress" max="0" value="0"></progress>
    
    <div class="container">
        
            <div class="navbar-header header-back2home-logo">
                <span class="logo_mark" >>$</span>
                <a href="https://ymingliu.github.io">
                    <span class="logo_text" >cd /home/</span>
                    <span class="logo_cursor" ></span>
                </a>
            </div>
        
        <div class="navbar-right">
                
                <span class="menu">
                
                <a class="menu-item" href="/posts/" title="">Blog</a>
                
                <a class="menu-item" href="/categories/" title="">Categories</a>
                
                <a class="menu-item" href="/tags/" title="">Tags</a>
                
                <a class="menu-item" href="/about/" title="">About</a>
                
                <span class="divide"></span>
                <a href="javascript:void(0);" class="theme-switch"><i class="iconfont icon-dark-mode"></i></a>
                </span>
        </div>
    </div>
</nav>
<nav class="navbar-mobile" id="nav-mobile" style="display: none">
    
        <progress class="content_progress" max="0" value="0"></progress>
    
     <div class="container">
        <div class="navbar">
            <div class="navbar-header header-logo">
                    <a href="https://ymingliu.github.io">Yiming`s Blog</a>
            </div>
            <div class="navbar-right">
                <div><a href="javascript:void(0);" class="theme-switch"><i class="iconfont icon-dark-mode"></i></a></div>
                <div class="menu-toggle">
                    <span></span><span></span><span></span>
                </div>
            </div>
        </div>
     
          <div class="menu" id="mobile-menu">
                <nav class="mb-md">
                    
                    
                        <a class="menu-item" href="/posts/" title="">
                            <h3>Blog</h3>
                            <div class="menu-active"></div>
                        </a>
                    
                        <a class="menu-item" href="/categories/" title="">
                            <h3>Categories</h3>
                            <div class="menu-active"></div>
                        </a>
                    
                        <a class="menu-item" href="/tags/" title="">
                            <h3>Tags</h3>
                            <div class="menu-active"></div>
                        </a>
                    
                        <a class="menu-item" href="/about/" title="">
                            <h3>About</h3>
                            <div class="menu-active"></div>
                        </a>
                    
                </nav>
        </div>
    </div>
</nav>
            <main class="main">
                <div class="container">
                    
<article class="post-warp" itemscope itemtype="http://schema.org/Article">
    <header class="post-header">
        <h1 class="post-title" itemprop="name headline">Advanced MySQL For Practice</h1>
        <div class="post-meta">
                Written by <a itemprop="name" href="https://ymingliu.github.io" rel="author">Yiming</a> with ♥
                <span class="post-time">
                on <time datetime=2021-03-10 itemprop="datePublished">March 10, 2021</time>
                </span>
                in
                
                <i class="iconfont icon-folder"></i>
                <span class="post-category">
                        
                        
                        
                          <a href="https://ymingliu.github.io/categories/mysql/"> MySQL, </a>
                        
                        
                </span>
                <span class="post-word-count">2410 words</span>
        </div>
    </header>

    <div class="post-content">
        

        
        

        
        
        
        
        

        
        
        

        <h2 id="课程参考">课程参考</h2>
<p><a href="https://developer.aliyun.com/learning/roadmap/database?spm=5176.12901015.0.i12901015.4ea8525cMC1llR">阿里云开发者社区——数据库学习路线</a></p>
<h2 id="数据库及sqlmysql进阶练习题">数据库及SQL/MySQL进阶练习题</h2>
<p>1、查出至少有一个员工的部门，显示部门编号、部门名称、部门位置、部门人数。</p>
<ul>
<li>列：d.deptno, d.dname, d.loc, 部门人数</li>
<li>表：dept d, emp e</li>
<li>条件：e.deptno=d.deptno</li>
</ul>
<p>思路：先统计每个部门的人数，作为一张新表，再利用内连接将该表与部门表合并，并去除笛卡尔积，最后显示需要的列（单独写出两部分，再利用连接，去除笛卡尔积）</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#a6e22e">mysql</span><span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">SELECT</span> <span style="color:#a6e22e">d</span>.<span style="color:#f92672">*</span>, <span style="color:#a6e22e">a</span>.<span style="color:#a6e22e">cnt</span> <span style="color:#a6e22e">FROM</span> <span style="color:#a6e22e">dept</span> <span style="color:#a6e22e">d</span> <span style="color:#a6e22e">INNER</span> <span style="color:#a6e22e">JOIN</span> (<span style="color:#a6e22e">SELECT</span> <span style="color:#a6e22e">deptno</span>, <span style="color:#a6e22e">COUNT</span>(<span style="color:#f92672">*</span>) <span style="color:#a6e22e">cnt</span> <span style="color:#a6e22e">FROM</span> <span style="color:#a6e22e">emp</span> <span style="color:#a6e22e">GROUP</span> <span style="color:#a6e22e">BY</span> <span style="color:#a6e22e">deptno</span> <span style="color:#a6e22e">HAVING</span> <span style="color:#a6e22e">COUNT</span>(<span style="color:#f92672">*</span>)<span style="color:#f92672">&gt;=</span><span style="color:#ae81ff">1</span>) <span style="color:#a6e22e">a</span> <span style="color:#a6e22e">WHERE</span> <span style="color:#a6e22e">d</span>.<span style="color:#a6e22e">deptno</span><span style="color:#f92672">=</span><span style="color:#a6e22e">a</span>.<span style="color:#a6e22e">deptno</span>;
</code></pre></div><table>
<thead>
<tr>
<th>deptno</th>
<th>dname</th>
<th>loc</th>
<th>cnt</th>
</tr>
</thead>
<tbody>
<tr>
<td>10</td>
<td>教研部</td>
<td>北京</td>
<td>3</td>
</tr>
<tr>
<td>20</td>
<td>学工部</td>
<td>上海</td>
<td>5</td>
</tr>
<tr>
<td>30</td>
<td>销售部</td>
<td>广州</td>
<td>6</td>
</tr>
</tbody>
</table>
<p>2、列出所有员工的姓名及其直接上级的姓名</p>
<ul>
<li>列：员工姓名，上级姓名</li>
<li>表：emp e, emp m</li>
<li>条件：员工的mgr=上级的empno</li>
</ul>
<p>思路：因为员工可能没有上级，但也要显示出来，因此用左外连接</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#a6e22e">mysql</span><span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">SELECT</span> <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">ename</span>, <span style="color:#a6e22e">m</span>.<span style="color:#a6e22e">ename</span> <span style="color:#a6e22e">FROM</span> <span style="color:#a6e22e">emp</span> <span style="color:#a6e22e">e</span> <span style="color:#a6e22e">LEFT</span> <span style="color:#a6e22e">OUTER</span> <span style="color:#a6e22e">JOIN</span> <span style="color:#a6e22e">emp</span> <span style="color:#a6e22e">m</span> <span style="color:#a6e22e">ON</span> <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">mgr</span><span style="color:#f92672">=</span><span style="color:#a6e22e">m</span>.<span style="color:#a6e22e">empno</span>;
</code></pre></div><table>
<thead>
<tr>
<th>ename</th>
<th>ename</th>
</tr>
</thead>
<tbody>
<tr>
<td>甘宁</td>
<td>庞统</td>
</tr>
<tr>
<td>黛绮丝</td>
<td>关羽</td>
</tr>
<tr>
<td>殷天正</td>
<td>关羽</td>
</tr>
<tr>
<td>刘备</td>
<td>曾阿牛</td>
</tr>
<tr>
<td>谢逊</td>
<td>关羽</td>
</tr>
<tr>
<td>关羽</td>
<td>曾阿牛</td>
</tr>
<tr>
<td>张飞</td>
<td>曾阿牛</td>
</tr>
<tr>
<td>诸葛亮</td>
<td>刘备</td>
</tr>
<tr>
<td>曾阿牛</td>
<td>NULL</td>
</tr>
<tr>
<td>韦一笑</td>
<td>关羽</td>
</tr>
<tr>
<td>周泰</td>
<td>诸葛亮</td>
</tr>
<tr>
<td>程普</td>
<td>关羽</td>
</tr>
<tr>
<td>庞统</td>
<td>刘备</td>
</tr>
<tr>
<td>黄盖</td>
<td>张飞</td>
</tr>
<tr>
<td>张三</td>
<td>甘宁</td>
</tr>
</tbody>
</table>
<p>3、列出受雇日期早于直接上级的所有员工的编号，姓名，部门名称</p>
<ul>
<li>列：empno, ename, d.dname</li>
<li>表：emp e, dept d, emp m</li>
<li>条件：e.hiredata&lt;m.hiredata</li>
</ul>
<p>思路：(1) 先不查部门名称，只查部门编号</p>
<ul>
<li>列：e.empno, e.ename, e.deptno</li>
<li>表：emp e, emp m</li>
<li>条件：e.mgr=m.empno, e.hiredata&lt;m.hiredata</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#a6e22e">mysql</span><span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">select</span> <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">empno</span>, <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">ename</span>, <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">deptno</span> <span style="color:#a6e22e">from</span> <span style="color:#a6e22e">emp</span> <span style="color:#a6e22e">e</span>, <span style="color:#a6e22e">emp</span> <span style="color:#a6e22e">m</span> <span style="color:#a6e22e">where</span> <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">mgr</span><span style="color:#f92672">=</span><span style="color:#a6e22e">m</span>.<span style="color:#a6e22e">empno</span> <span style="color:#a6e22e">and</span> <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">hiredate</span><span style="color:#f92672">&lt;</span><span style="color:#a6e22e">m</span>.<span style="color:#a6e22e">hiredate</span>;
</code></pre></div><p>(2) 再加入部门表，取编号对应部门的名称</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#a6e22e">mysql</span><span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">select</span> <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">empno</span>, <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">ename</span>, <span style="color:#a6e22e">d</span>.<span style="color:#a6e22e">dname</span> <span style="color:#a6e22e">from</span> <span style="color:#a6e22e">emp</span> <span style="color:#a6e22e">e</span>, <span style="color:#a6e22e">emp</span> <span style="color:#a6e22e">m</span>, <span style="color:#a6e22e">dept</span> <span style="color:#a6e22e">d</span> <span style="color:#a6e22e">where</span> <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">mgr</span><span style="color:#f92672">=</span><span style="color:#a6e22e">m</span>.<span style="color:#a6e22e">empno</span> <span style="color:#a6e22e">and</span> <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">hiredate</span><span style="color:#f92672">&lt;</span><span style="color:#a6e22e">m</span>.<span style="color:#a6e22e">hiredate</span> <span style="color:#a6e22e">and</span> <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">deptno</span><span style="color:#f92672">=</span><span style="color:#a6e22e">d</span>.<span style="color:#a6e22e">deptno</span>;
</code></pre></div><table>
<thead>
<tr>
<th>empno</th>
<th>ename</th>
<th>dname</th>
</tr>
</thead>
<tbody>
<tr>
<td>1002</td>
<td>黛绮丝</td>
<td>销售部</td>
</tr>
<tr>
<td>1003</td>
<td>殷天正</td>
<td>销售部</td>
</tr>
<tr>
<td>1004</td>
<td>刘备</td>
<td>学工部</td>
</tr>
<tr>
<td>1006</td>
<td>关羽</td>
<td>销售部</td>
</tr>
<tr>
<td>1007</td>
<td>张飞</td>
<td>教研部</td>
</tr>
<tr>
<td>1001</td>
<td>甘宁</td>
<td>学工部</td>
</tr>
</tbody>
</table>
<p><strong>本题的重点在于<code>FROM</code>后可以连多张表，<code>WHERE</code>后条件可以加多个！</strong></p>
<p>4、列出部门名称和这些部门的员工信息，同时列出那些没有员工的部门</p>
<ul>
<li>列：d.dname，e.*</li>
<li>表：emp e, dept d</li>
<li>条件：e.deptno=d.deptno</li>
</ul>
<p>思路：(1) 先不管没有员工的部门</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#a6e22e">mysql</span><span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">SELECT</span> <span style="color:#f92672">*</span> <span style="color:#a6e22e">FROM</span> <span style="color:#a6e22e">emp</span> <span style="color:#a6e22e">e</span>, <span style="color:#a6e22e">dept</span> <span style="color:#a6e22e">d</span> <span style="color:#a6e22e">WHERE</span> <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">deptno</span><span style="color:#f92672">=</span><span style="color:#a6e22e">d</span>.<span style="color:#a6e22e">deptno</span>;
</code></pre></div><p>(2) 用右外连接显示没有员工的部门</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#a6e22e">mysql</span><span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">SELECT</span> <span style="color:#f92672">*</span> <span style="color:#a6e22e">FROM</span> <span style="color:#a6e22e">emp</span> <span style="color:#a6e22e">e</span> <span style="color:#a6e22e">RIGHT</span> <span style="color:#a6e22e">OUTER</span> <span style="color:#a6e22e">JOIN</span> <span style="color:#a6e22e">dept</span> <span style="color:#a6e22e">d</span> <span style="color:#a6e22e">ON</span> <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">deptno</span><span style="color:#f92672">=</span><span style="color:#a6e22e">d</span>.<span style="color:#a6e22e">deptno</span>;
</code></pre></div><p>5、列出最低薪金大于15000的各种工作及从事此工作的员工人数</p>
<ul>
<li>列：job, count(*)</li>
<li>表：emp</li>
<li>条件：min(sal)&gt;15000</li>
<li>分组：job</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#a6e22e">mysql</span><span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">SELECT</span> <span style="color:#a6e22e">job</span>, <span style="color:#a6e22e">COUNT</span>(<span style="color:#f92672">*</span>) <span style="color:#a6e22e">FROM</span> <span style="color:#a6e22e">emp</span> <span style="color:#a6e22e">GROUP</span> <span style="color:#a6e22e">BY</span> <span style="color:#a6e22e">job</span> <span style="color:#a6e22e">HAVING</span> <span style="color:#a6e22e">MIN</span>(<span style="color:#a6e22e">sal</span>)<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">15000</span>;
</code></pre></div><table>
<thead>
<tr>
<th>job</th>
<th>count(*)</th>
</tr>
</thead>
<tbody>
<tr>
<td>经理</td>
<td>3</td>
</tr>
<tr>
<td>分析师</td>
<td>2</td>
</tr>
<tr>
<td>董事长</td>
<td>1</td>
</tr>
<tr>
<td>保洁员</td>
<td>1</td>
</tr>
</tbody>
</table>
<p><strong>本题重点在于有聚合函数的一定是在分组后，用<code>HAVING</code></strong></p>
<p>6、列出在销售部工作的员工姓名，假定不知道销售部的部门编号</p>
<ul>
<li>列：e.ename</li>
<li>表：emp e, dept d</li>
<li>条件：e.deptno=d.deptno and d.dname=‘销售部&rsquo;</li>
</ul>
<p>思路：(1) 利用子查询，先把销售部的部门编号查出来</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#a6e22e">mysql</span><span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">SELECT</span> <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">ename</span> <span style="color:#a6e22e">FROM</span> <span style="color:#a6e22e">emp</span> <span style="color:#a6e22e">e</span> <span style="color:#a6e22e">WHERE</span> <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">deptno</span><span style="color:#f92672">=</span>(<span style="color:#a6e22e">SELECT</span> <span style="color:#a6e22e">deptno</span> <span style="color:#a6e22e">FROM</span> <span style="color:#a6e22e">dept</span> <span style="color:#a6e22e">WHERE</span> <span style="color:#a6e22e">dname</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#39;销售部&#39;</span>);
</code></pre></div><p>(2) 或者先连接两张表，再提取部门名称为销售部的员工</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#a6e22e">mysql</span><span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">SELECT</span> <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">ename</span> <span style="color:#a6e22e">FROM</span> <span style="color:#a6e22e">emp</span> <span style="color:#a6e22e">e</span>, <span style="color:#a6e22e">dept</span> <span style="color:#a6e22e">d</span> <span style="color:#a6e22e">WHERE</span> <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">deptno</span><span style="color:#f92672">=</span><span style="color:#a6e22e">d</span>.<span style="color:#a6e22e">deptno</span> <span style="color:#a6e22e">AND</span> <span style="color:#a6e22e">d</span>.<span style="color:#a6e22e">dname</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#39;销售部&#39;</span>;
</code></pre></div><table>
<thead>
<tr>
<th>ename</th>
</tr>
</thead>
<tbody>
<tr>
<td>黛绮丝</td>
</tr>
<tr>
<td>殷天正</td>
</tr>
<tr>
<td>谢逊</td>
</tr>
<tr>
<td>关羽</td>
</tr>
<tr>
<td>韦一笑</td>
</tr>
<tr>
<td>程普</td>
</tr>
</tbody>
</table>
<p><strong>本题第二种做法如果数据量很大会占内存，不建议使用，最好还是用子查询</strong></p>
<p>7、列出薪金高于公司平均薪金的所有员工信息，所在部门名称，上级领导，工资等级</p>
<p>思路：(1) 先不查工资等级</p>
<ul>
<li>列：e.ename, d.dname, m.ename</li>
<li>表：emp e, emp m, dept d</li>
<li>条件：e.sal&gt;(select avg(e.sal) from emp) and e.mgr=m.empno and e.deptno=d.deptno</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#a6e22e">mysql</span><span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">SELECT</span> <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">ename</span>, <span style="color:#a6e22e">d</span>.<span style="color:#a6e22e">dname</span>, <span style="color:#a6e22e">m</span>.<span style="color:#a6e22e">ename</span> <span style="color:#a6e22e">FROM</span> <span style="color:#a6e22e">emp</span> <span style="color:#a6e22e">e</span>, <span style="color:#a6e22e">emp</span> <span style="color:#a6e22e">m</span>, <span style="color:#a6e22e">dept</span> <span style="color:#a6e22e">d</span> <span style="color:#a6e22e">WHERE</span> <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">sal</span><span style="color:#f92672">&gt;</span>(<span style="color:#a6e22e">SELECT</span> <span style="color:#a6e22e">AVG</span>(<span style="color:#a6e22e">sal</span>) <span style="color:#a6e22e">FROM</span> <span style="color:#a6e22e">emp</span>) <span style="color:#a6e22e">AND</span> <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">mgr</span><span style="color:#f92672">=</span><span style="color:#a6e22e">m</span>.<span style="color:#a6e22e">empno</span> <span style="color:#a6e22e">AND</span> <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">deptno</span><span style="color:#f92672">=</span><span style="color:#a6e22e">d</span>.<span style="color:#a6e22e">deptno</span>;
</code></pre></div><table>
<thead>
<tr>
<th>ename</th>
<th>dname</th>
<th>ename</th>
</tr>
</thead>
<tbody>
<tr>
<td>诸葛亮</td>
<td>学工部</td>
<td>刘备</td>
</tr>
<tr>
<td>庞统</td>
<td>学工部</td>
<td>刘备</td>
</tr>
<tr>
<td>刘备</td>
<td>学工部</td>
<td>曾阿牛</td>
</tr>
<tr>
<td>关羽</td>
<td>销售部</td>
<td>曾阿牛</td>
</tr>
</tbody>
</table>
<p>(2) 再连接工资等级表</p>
<ul>
<li>列：e.ename, d.dname, m.ename, s.grade</li>
<li>表：emp e, emp m, dept d, salgrade s</li>
<li>条件：e.sal&gt;(select avg(e.sal) from emp) and e.mgr=m.empno and e.deptno=d.deptno and e.sal between s.losal and s.hisal</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#a6e22e">mysql</span><span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">SELECT</span> <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">ename</span>, <span style="color:#a6e22e">d</span>.<span style="color:#a6e22e">dname</span>, <span style="color:#a6e22e">m</span>.<span style="color:#a6e22e">ename</span>, <span style="color:#a6e22e">s</span>.<span style="color:#a6e22e">grade</span> <span style="color:#a6e22e">FROM</span> <span style="color:#a6e22e">emp</span> <span style="color:#a6e22e">e</span>, <span style="color:#a6e22e">emp</span> <span style="color:#a6e22e">m</span>, <span style="color:#a6e22e">dept</span> <span style="color:#a6e22e">d</span>, <span style="color:#a6e22e">salgrade</span> <span style="color:#a6e22e">s</span> <span style="color:#a6e22e">WHERE</span> <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">sal</span><span style="color:#f92672">&gt;</span>(<span style="color:#a6e22e">SELECT</span> <span style="color:#a6e22e">AVG</span>(<span style="color:#a6e22e">sal</span>) <span style="color:#a6e22e">FROM</span> <span style="color:#a6e22e">emp</span>) <span style="color:#a6e22e">AND</span> <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">mgr</span><span style="color:#f92672">=</span><span style="color:#a6e22e">m</span>.<span style="color:#a6e22e">empno</span> <span style="color:#a6e22e">AND</span> <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">deptno</span><span style="color:#f92672">=</span><span style="color:#a6e22e">d</span>.<span style="color:#a6e22e">deptno</span> <span style="color:#a6e22e">AND</span> <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">sal</span> <span style="color:#a6e22e">BETWEEN</span> <span style="color:#a6e22e">s</span>.<span style="color:#a6e22e">losal</span> <span style="color:#a6e22e">AND</span> <span style="color:#a6e22e">s</span>.<span style="color:#a6e22e">hisal</span>;
</code></pre></div><table>
<thead>
<tr>
<th>ename</th>
<th>dname</th>
<th>ename</th>
<th>grade</th>
</tr>
</thead>
<tbody>
<tr>
<td>诸葛亮</td>
<td>学工部</td>
<td>刘备</td>
<td>4</td>
</tr>
<tr>
<td>庞统</td>
<td>学工部</td>
<td>刘备</td>
<td>4</td>
</tr>
<tr>
<td>刘备</td>
<td>学工部</td>
<td>曾阿牛</td>
<td>4</td>
</tr>
<tr>
<td>关羽</td>
<td>销售部</td>
<td>曾阿牛</td>
<td>4</td>
</tr>
</tbody>
</table>
<p>(3) 最后消除员工没有上级，员工部门不存在的情况</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#a6e22e">mysql</span><span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">SELECT</span> <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">ename</span>, <span style="color:#a6e22e">d</span>.<span style="color:#a6e22e">dname</span>, <span style="color:#a6e22e">m</span>.<span style="color:#a6e22e">ename</span>, <span style="color:#a6e22e">s</span>.<span style="color:#a6e22e">grade</span>
<span style="color:#960050;background-color:#1e0010">—</span><span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">FROM</span>
<span style="color:#960050;background-color:#1e0010">—</span><span style="color:#f92672">&gt;</span>   <span style="color:#a6e22e">emp</span> <span style="color:#a6e22e">e</span> <span style="color:#a6e22e">LEFT</span> <span style="color:#a6e22e">OUTER</span> <span style="color:#a6e22e">JOIN</span> <span style="color:#a6e22e">dept</span> <span style="color:#a6e22e">d</span> <span style="color:#a6e22e">ON</span> <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">deptno</span><span style="color:#f92672">=</span><span style="color:#a6e22e">d</span>.<span style="color:#a6e22e">deptno</span>
<span style="color:#960050;background-color:#1e0010">—</span><span style="color:#f92672">&gt;</span>         <span style="color:#a6e22e">LEFT</span> <span style="color:#a6e22e">OUTER</span> <span style="color:#a6e22e">JOIN</span> <span style="color:#a6e22e">emp</span> <span style="color:#a6e22e">m</span> <span style="color:#a6e22e">ON</span> <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">mgr</span><span style="color:#f92672">=</span><span style="color:#a6e22e">m</span>.<span style="color:#a6e22e">empno</span>
<span style="color:#960050;background-color:#1e0010">—</span><span style="color:#f92672">&gt;</span>         <span style="color:#a6e22e">LEFT</span> <span style="color:#a6e22e">OUTER</span> <span style="color:#a6e22e">JOIN</span> <span style="color:#a6e22e">salgrade</span> <span style="color:#a6e22e">s</span> <span style="color:#a6e22e">ON</span> <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">sal</span> <span style="color:#a6e22e">BETWEEN</span> <span style="color:#a6e22e">s</span>.<span style="color:#a6e22e">losal</span> <span style="color:#a6e22e">AND</span> <span style="color:#a6e22e">s</span>.<span style="color:#a6e22e">hisal</span>
<span style="color:#960050;background-color:#1e0010">—</span><span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">WHERE</span> <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">sal</span><span style="color:#f92672">&gt;</span>(<span style="color:#a6e22e">SELECT</span> <span style="color:#a6e22e">AVG</span>(<span style="color:#a6e22e">sal</span>) <span style="color:#a6e22e">FROM</span> <span style="color:#a6e22e">emp</span>)
</code></pre></div><table>
<thead>
<tr>
<th>ename</th>
<th>dname</th>
<th>ename</th>
<th>grade</th>
</tr>
</thead>
<tbody>
<tr>
<td>刘备</td>
<td>学工部</td>
<td>曾阿牛</td>
<td>4</td>
</tr>
<tr>
<td>关羽</td>
<td>销售部</td>
<td>曾阿牛</td>
<td>4</td>
</tr>
<tr>
<td>诸葛亮</td>
<td>学工部</td>
<td>刘备</td>
<td>4</td>
</tr>
<tr>
<td>曾阿牛</td>
<td>教研部</td>
<td>NULL</td>
<td>5</td>
</tr>
<tr>
<td>庞统</td>
<td>学工部</td>
<td>刘备</td>
<td>4</td>
</tr>
<tr>
<td>张三</td>
<td>NULL</td>
<td>甘宁</td>
<td>5</td>
</tr>
</tbody>
</table>
<p><strong>本题有两个重点，一是需要子查询和多表连接，而是多表左外连接用法，即连接一张表后立即给出<code>ON</code>连接条件，子查询放在<code>WHERE</code>中</strong></p>
<p>10、列出与庞统从事相同工作的所有员工及部门名称</p>
<ul>
<li>列：e.*, d.dname</li>
<li>表：emp e, dept d</li>
<li>条件：e.deptno=d.deptno and e.job=(select job from emp where ename=‘庞统&rsquo;)</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#a6e22e">mysql</span><span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">SELECT</span> <span style="color:#a6e22e">e</span>.<span style="color:#f92672">*</span>, <span style="color:#a6e22e">d</span>.<span style="color:#a6e22e">dname</span> <span style="color:#a6e22e">FROM</span> <span style="color:#a6e22e">emp</span> <span style="color:#a6e22e">e</span> <span style="color:#a6e22e">LEFT</span> <span style="color:#a6e22e">OUTER</span> <span style="color:#a6e22e">JOIN</span> <span style="color:#a6e22e">dept</span> <span style="color:#a6e22e">d</span> <span style="color:#a6e22e">ON</span> <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">deptno</span><span style="color:#f92672">=</span><span style="color:#a6e22e">d</span>.<span style="color:#a6e22e">deptno</span> <span style="color:#a6e22e">WHERE</span> <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">job</span><span style="color:#f92672">=</span>(<span style="color:#a6e22e">SELECT</span> <span style="color:#a6e22e">job</span> <span style="color:#a6e22e">FROM</span> <span style="color:#a6e22e">emp</span> <span style="color:#a6e22e">WHERE</span> <span style="color:#a6e22e">ename</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#39;庞统&#39;</span>);
</code></pre></div><table>
<thead>
<tr>
<th>empno</th>
<th>ename</th>
<th>job</th>
<th>mgr</th>
<th>hiredate</th>
<th>sal</th>
<th>comm</th>
<th>deptno</th>
<th>dname</th>
</tr>
</thead>
<tbody>
<tr>
<td>1008</td>
<td>诸葛亮</td>
<td>分析师</td>
<td>1004</td>
<td>2007-04-19</td>
<td>30000</td>
<td>NULL</td>
<td>20</td>
<td>学工部</td>
</tr>
<tr>
<td>1013</td>
<td>庞统</td>
<td>分析师</td>
<td>1004</td>
<td>2001-12-03</td>
<td>30000</td>
<td>NULL</td>
<td>20</td>
<td>学工部</td>
</tr>
</tbody>
</table>
<p>11、列出薪金高于在部门30工作的所有员工的薪金的员工姓名和薪金，部门名称</p>
<ul>
<li>列：e.ename, e.sal, d.dname</li>
<li>表：emp e, dept d</li>
<li>条件：e.sal&gt;(select max(sal) from emp group by deptno having deptno=30) and e.deptno=d.deptno</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#a6e22e">mysql</span><span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">SELECT</span> <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">ename</span>, <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">sal</span>, <span style="color:#a6e22e">d</span>.<span style="color:#a6e22e">dname</span> <span style="color:#a6e22e">FROM</span> <span style="color:#a6e22e">emp</span> <span style="color:#a6e22e">e</span> <span style="color:#a6e22e">LEFT</span> <span style="color:#a6e22e">OUTER</span> <span style="color:#a6e22e">JOIN</span> <span style="color:#a6e22e">dept</span> <span style="color:#a6e22e">d</span> <span style="color:#a6e22e">ON</span> <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">deptno</span><span style="color:#f92672">=</span><span style="color:#a6e22e">d</span>.<span style="color:#a6e22e">deptno</span> <span style="color:#a6e22e">WHERE</span> <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">sal</span><span style="color:#f92672">&gt;</span>(<span style="color:#a6e22e">SELECT</span> <span style="color:#a6e22e">MAX</span>(<span style="color:#a6e22e">sal</span>) <span style="color:#a6e22e">FROM</span> <span style="color:#a6e22e">emp</span> <span style="color:#a6e22e">GROUP</span> <span style="color:#a6e22e">BY</span> <span style="color:#a6e22e">deptno</span> <span style="color:#a6e22e">HAVING</span> <span style="color:#a6e22e">deptno</span><span style="color:#f92672">=</span><span style="color:#ae81ff">30</span>);
</code></pre></div><table>
<thead>
<tr>
<th>ename</th>
<th>sal</th>
<th>dname</th>
</tr>
</thead>
<tbody>
<tr>
<td>刘备</td>
<td>29750</td>
<td>学工部</td>
</tr>
<tr>
<td>诸葛亮</td>
<td>30000</td>
<td>学工部</td>
</tr>
<tr>
<td>曾阿牛</td>
<td>50000</td>
<td>教研部</td>
</tr>
<tr>
<td>庞统</td>
<td>30000</td>
<td>学工部</td>
</tr>
<tr>
<td>张三</td>
<td>80000</td>
<td>NULL</td>
</tr>
</tbody>
</table>
<p>或者</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#a6e22e">mysql</span><span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">SELECT</span> <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">ename</span>, <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">sal</span>, <span style="color:#a6e22e">d</span>.<span style="color:#a6e22e">dname</span> <span style="color:#a6e22e">FROM</span> <span style="color:#a6e22e">emp</span> <span style="color:#a6e22e">e</span> <span style="color:#a6e22e">LEFT</span> <span style="color:#a6e22e">OUTER</span> <span style="color:#a6e22e">JOIN</span> <span style="color:#a6e22e">dept</span> <span style="color:#a6e22e">d</span> <span style="color:#a6e22e">ON</span> <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">deptno</span><span style="color:#f92672">=</span><span style="color:#a6e22e">d</span>.<span style="color:#a6e22e">deptno</span> <span style="color:#a6e22e">WHERE</span> <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">sal</span> <span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">ALL</span> (<span style="color:#a6e22e">SELECT</span> <span style="color:#a6e22e">sal</span> <span style="color:#a6e22e">FROM</span> <span style="color:#a6e22e">emp</span> <span style="color:#a6e22e">WHERE</span> <span style="color:#a6e22e">deptno</span><span style="color:#f92672">=</span><span style="color:#ae81ff">30</span>);
</code></pre></div><p>或者普通的内连接即可，不需要左外连接</p>
<p>12、查出年份、利润、年度增长比（即要求多出一列，显示增长比）</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#a6e22e">mysql</span><span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">SELECT</span> <span style="color:#f92672">*</span> <span style="color:#a6e22e">FROM</span> <span style="color:#a6e22e">tb_year</span>;
</code></pre></div><table>
<thead>
<tr>
<th>year</th>
<th>zz</th>
</tr>
</thead>
<tbody>
<tr>
<td>2010</td>
<td>100</td>
</tr>
<tr>
<td>2011</td>
<td>150</td>
</tr>
<tr>
<td>2012</td>
<td>250</td>
</tr>
<tr>
<td>2013</td>
<td>800</td>
</tr>
<tr>
<td>2014</td>
<td>1000</td>
</tr>
</tbody>
</table>
<p>思路：(1) 先把相邻两年的利润放在一行</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#a6e22e">mysql</span><span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">SELECT</span> <span style="color:#f92672">*</span> <span style="color:#a6e22e">FROM</span> <span style="color:#a6e22e">tb_year</span> <span style="color:#a6e22e">y1</span>, <span style="color:#a6e22e">tb_year</span> <span style="color:#a6e22e">y2</span>;
</code></pre></div><table>
<thead>
<tr>
<th>year</th>
<th>zz</th>
<th>year</th>
<th>zz</th>
</tr>
</thead>
<tbody>
<tr>
<td>2010</td>
<td>100</td>
<td>2010</td>
<td>100</td>
</tr>
<tr>
<td>2011</td>
<td>150</td>
<td>2010</td>
<td>100</td>
</tr>
<tr>
<td>2012</td>
<td>250</td>
<td>2010</td>
<td>100</td>
</tr>
<tr>
<td>2013</td>
<td>800</td>
<td>2010</td>
<td>100</td>
</tr>
<tr>
<td>2014</td>
<td>1000</td>
<td>2010</td>
<td>100</td>
</tr>
<tr>
<td>2010</td>
<td>100</td>
<td>2011</td>
<td>150</td>
</tr>
<tr>
<td>2011</td>
<td>150</td>
<td>2011</td>
<td>150</td>
</tr>
<tr>
<td>2012</td>
<td>250</td>
<td>2011</td>
<td>150</td>
</tr>
<tr>
<td>2013</td>
<td>800</td>
<td>2011</td>
<td>150</td>
</tr>
<tr>
<td>2014</td>
<td>1000</td>
<td>2011</td>
<td>150</td>
</tr>
<tr>
<td>2010</td>
<td>100</td>
<td>2012</td>
<td>250</td>
</tr>
<tr>
<td>2011</td>
<td>150</td>
<td>2012</td>
<td>250</td>
</tr>
<tr>
<td>2012</td>
<td>250</td>
<td>2012</td>
<td>250</td>
</tr>
<tr>
<td>2013</td>
<td>800</td>
<td>2012</td>
<td>250</td>
</tr>
<tr>
<td>2014</td>
<td>1000</td>
<td>2012</td>
<td>250</td>
</tr>
<tr>
<td>2010</td>
<td>100</td>
<td>2013</td>
<td>800</td>
</tr>
<tr>
<td>2011</td>
<td>150</td>
<td>2013</td>
<td>800</td>
</tr>
<tr>
<td>2012</td>
<td>250</td>
<td>2013</td>
<td>800</td>
</tr>
<tr>
<td>2013</td>
<td>800</td>
<td>2013</td>
<td>800</td>
</tr>
<tr>
<td>2014</td>
<td>1000</td>
<td>2013</td>
<td>800</td>
</tr>
<tr>
<td>2010</td>
<td>100</td>
<td>2014</td>
<td>1000</td>
</tr>
<tr>
<td>2011</td>
<td>150</td>
<td>2014</td>
<td>1000</td>
</tr>
<tr>
<td>2012</td>
<td>250</td>
<td>2014</td>
<td>1000</td>
</tr>
<tr>
<td>2013</td>
<td>800</td>
<td>2014</td>
<td>1000</td>
</tr>
<tr>
<td>2014</td>
<td>1000</td>
<td>2014</td>
<td>1000</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#a6e22e">mysql</span><span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">SELECT</span> <span style="color:#f92672">*</span> <span style="color:#a6e22e">FROM</span> <span style="color:#a6e22e">tb_year</span> <span style="color:#a6e22e">y1</span>, <span style="color:#a6e22e">tb_year</span> <span style="color:#a6e22e">y2</span> <span style="color:#a6e22e">WHERE</span> <span style="color:#a6e22e">y1</span>.<span style="color:#a6e22e">year</span><span style="color:#f92672">=</span><span style="color:#a6e22e">y2</span>.<span style="color:#a6e22e">year</span><span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>;
</code></pre></div><table>
<thead>
<tr>
<th>year</th>
<th>zz</th>
<th>year</th>
<th>zz</th>
</tr>
</thead>
<tbody>
<tr>
<td>2011</td>
<td>150</td>
<td>2010</td>
<td>100</td>
</tr>
<tr>
<td>2012</td>
<td>250</td>
<td>2011</td>
<td>150</td>
</tr>
<tr>
<td>2013</td>
<td>800</td>
<td>2012</td>
<td>250</td>
</tr>
<tr>
<td>2014</td>
<td>1000</td>
<td>2013</td>
<td>800</td>
</tr>
</tbody>
</table>
<p>注意用左外连接</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#a6e22e">mysql</span><span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">SELECT</span> <span style="color:#f92672">*</span> <span style="color:#a6e22e">FROM</span> <span style="color:#a6e22e">tb_year</span> <span style="color:#a6e22e">y1</span> <span style="color:#a6e22e">LEFT</span> <span style="color:#a6e22e">OUTER</span> <span style="color:#a6e22e">JOIN</span> <span style="color:#a6e22e">tb_year</span> <span style="color:#a6e22e">y2</span> <span style="color:#a6e22e">ON</span> <span style="color:#a6e22e">y1</span>.<span style="color:#a6e22e">year</span><span style="color:#f92672">=</span><span style="color:#a6e22e">y2</span>.<span style="color:#a6e22e">year</span><span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>;
</code></pre></div><table>
<thead>
<tr>
<th>year</th>
<th>zz</th>
<th>year</th>
<th>zz</th>
</tr>
</thead>
<tbody>
<tr>
<td>2010</td>
<td>100</td>
<td>NULL</td>
<td>NULL</td>
</tr>
<tr>
<td>2011</td>
<td>150</td>
<td>2010</td>
<td>100</td>
</tr>
<tr>
<td>2012</td>
<td>250</td>
<td>2011</td>
<td>150</td>
</tr>
<tr>
<td>2013</td>
<td>800</td>
<td>2012</td>
<td>250</td>
</tr>
<tr>
<td>2014</td>
<td>1000</td>
<td>2013</td>
<td>800</td>
</tr>
</tbody>
</table>
<p>(2) 计算增长比</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#a6e22e">mysql</span><span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">SELECT</span> <span style="color:#a6e22e">y1</span>.<span style="color:#f92672">*</span>, (<span style="color:#a6e22e">y1</span>.<span style="color:#a6e22e">zz</span><span style="color:#f92672">-</span><span style="color:#a6e22e">y2</span>.<span style="color:#a6e22e">zz</span>)<span style="color:#f92672">/</span><span style="color:#a6e22e">y1</span>.<span style="color:#a6e22e">zz</span><span style="color:#f92672">*</span><span style="color:#ae81ff">100</span> <span style="color:#a6e22e">FROM</span> <span style="color:#a6e22e">tb_year</span> <span style="color:#a6e22e">y1</span> <span style="color:#a6e22e">LEFT</span> <span style="color:#a6e22e">OUTER</span> <span style="color:#a6e22e">JOIN</span> <span style="color:#a6e22e">tb_year</span> <span style="color:#a6e22e">y2</span> <span style="color:#a6e22e">ON</span> <span style="color:#a6e22e">y1</span>.<span style="color:#a6e22e">year</span><span style="color:#f92672">=</span><span style="color:#a6e22e">y2</span>.<span style="color:#a6e22e">year</span><span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>;
</code></pre></div><table>
<thead>
<tr>
<th>year</th>
<th>zz</th>
<th>(y1.zz-y2.zz)/y1.zz*100</th>
</tr>
</thead>
<tbody>
<tr>
<td>2010</td>
<td>100</td>
<td>NULL</td>
</tr>
<tr>
<td>2011</td>
<td>150</td>
<td>33.33333333333333</td>
</tr>
<tr>
<td>2012</td>
<td>250</td>
<td>40</td>
</tr>
<tr>
<td>2013</td>
<td>800</td>
<td>68.75</td>
</tr>
<tr>
<td>2014</td>
<td>1000</td>
<td>20</td>
</tr>
</tbody>
</table>
<p>(3) 根据显示要求修改</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#a6e22e">mysql</span><span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">SELECT</span> <span style="color:#a6e22e">y1</span>.<span style="color:#f92672">*</span>, <span style="color:#a6e22e">CONCAT</span>(<span style="color:#a6e22e">IFNULL</span>((<span style="color:#a6e22e">y1</span>.<span style="color:#a6e22e">zz</span><span style="color:#f92672">-</span><span style="color:#a6e22e">y2</span>.<span style="color:#a6e22e">zz</span>)<span style="color:#f92672">/</span><span style="color:#a6e22e">y2</span>.<span style="color:#a6e22e">zz</span><span style="color:#f92672">*</span><span style="color:#ae81ff">100</span>, <span style="color:#ae81ff">0</span>), <span style="color:#e6db74">&#39;%&#39;</span>) <span style="color:#a6e22e">增长比</span> <span style="color:#a6e22e">FROM</span> <span style="color:#a6e22e">tb_year</span> <span style="color:#a6e22e">y1</span> <span style="color:#a6e22e">LEFT</span> <span style="color:#a6e22e">OUTER</span> <span style="color:#a6e22e">JOIN</span> <span style="color:#a6e22e">tb_year</span> <span style="color:#a6e22e">y2</span> <span style="color:#a6e22e">ON</span> <span style="color:#a6e22e">y1</span>.<span style="color:#a6e22e">year</span><span style="color:#f92672">=</span><span style="color:#a6e22e">y2</span>.<span style="color:#a6e22e">year</span><span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>;
</code></pre></div><table>
<thead>
<tr>
<th>year</th>
<th>zz</th>
<th>增长比</th>
</tr>
</thead>
<tbody>
<tr>
<td>2010</td>
<td>100</td>
<td>0%</td>
</tr>
<tr>
<td>2011</td>
<td>150</td>
<td>50%</td>
</tr>
<tr>
<td>2012</td>
<td>250</td>
<td>66.66666666666666%</td>
</tr>
<tr>
<td>2013</td>
<td>800</td>
<td>220.00000000000003%</td>
</tr>
<tr>
<td>2014</td>
<td>1000</td>
<td>25%</td>
</tr>
</tbody>
</table>
<p>因此，<strong>本题最终考察的是一个隐秘的关联关系，即<code>y1.year=y2.year+1</code></strong>，将两数据放在一行是为了方便数学运算。</p>

    </div>

    <div class="post-copyright">
            
            <p class="copyright-item">
                <span>Author:</span>
                <span>Yiming </span>
                </p>
            

            
            <p class="copyright-item">
                    <span>Link:</span>
                    <a href=https://ymingliu.github.io/2021/sql-advanced-practice/>https://ymingliu.github.io/2021/sql-advanced-practice/</span>
            </p>
            
            
    </div>


    <div class="post-tags">
        
            <section>
            <i class="iconfont icon-tag"></i>Tag(s):
            
            <span class="tag"><a href="https://ymingliu.github.io/tags/mysql/">
                    #MySQL</a></span>
            
            </section>
        
        <section>
                <a href="javascript:window.history.back();">back</a></span> ·
                <span><a href="https://ymingliu.github.io">home</a></span>
        </section>
    </div>

    <div class="post-nav">
        
        <a href="https://ymingliu.github.io/2021/sql-advanced/" class="prev" rel="prev" title="Advanced MySQL"><i class="iconfont icon-left"></i>&nbsp;Advanced MySQL</a>
        
        
        <a href="https://ymingliu.github.io/2021/sql-advanced-application/" class="next" rel="next" title="MySQL Advanced Application">MySQL Advanced Application&nbsp;<i class="iconfont icon-right"></i></a>
        
    </div>

    <div class="post-comment">
        
            
                <div id="gitalk-container"></div>
<link rel="stylesheet" href="https://cdn.bootcss.com/gitalk/1.5.2/gitalk.css">
<script src="https://cdn.bootcss.com/gitalk/1.5.2/gitalk.min.js"></script>
<script>
    const gitalk = new Gitalk({

        clientID: '',
        clientSecret: '',
        repo: '',
        owner: 'ymingliu',
        admin: ['ymingliu'],
        id: location.pathname, 
        distractionFreeMode: false 
    });
    (function () {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('gitalk-container').innerHTML = 'Gitalk comments not available by default when the website is previewed locally.';
            return;
        }
        gitalk.render('gitalk-container');
    })();
</script>

            
        
    </div>
</article>
                </div>
            </main>
            <footer class="footer">
    <div class="copyright">
        &copy;
        
        <span itemprop="copyrightYear">2021 - 2021</span>
        
        <span class="with-love">
    	 <i class="iconfont icon-love"></i>
         </span>
         
            <span class="author" itemprop="copyrightHolder"><a href="https://ymingliu.github.io">Yiming</a> | </span>
         

         
		  <span>Powered by <a href="https://gohugo.io/" target="_blank" rel="external nofollow">Hugo</a> & <a href="https://github.com/Mogeko/Mogege" target="_blank" rel="external nofollow">Mogege</a></span>
    </div>
</footer>






<script defer src="/js/vendor_main.min.js"></script>







<script src="https://cdn.jsdelivr.net/npm/pangu@4.0.7/dist/browser/pangu.min.js" integrity="sha256-j+yj56cdEY2CwkVtGyz18fNybFGpMGJ8JxG3GSyO2+I=" crossorigin="anonymous"></script>
<script> pangu.spacingPage();</script>





        </div>
    </body>
</html>
